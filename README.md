![](https://www.prmry.io/static/prmry.png)


#### PRMRY AI Hub for prompt engineering interaction management.


<!-- TOC -->

* [Local deployment](#local-deployment)
* [Design](#design)
* [Components](#components)
* [Reference](#reference)
* [Contributing](#contributing)
<!-- TOC -->

## Local deployment

1. Create a .env file and configure the app:
   ```shell
   cp .env.example .env
   ``` 
   See here for info about getting Github and Google [oauth credentials](docs/oauth.md).
2. Spin up the docker containers to start MySQL and NGINX.
   ```shell
   docker-compose up -d
   ```
3. Run the app:
   
   *either* using the wrapper script (will restart the process if any .templ files change): 
   ```
   ./scripts/watch.sh
   ```
   
   *or* via Heroku using the included _Procfile_: 
     ```
     heroku local
     ```

#  Design
This application renders HTML markup server-side, using the [Templ templating language](https://templ.guide/) to define components which are (_very_) loosely similar to React components, but written in Go. Interactivity and SPA behavior is achieved with HTMX, an extension to HTML that extends its capability via `hx-*` attributes, which allow behavior to be defined in the HTML markup.  For example to trigger a `GET` request from a button click, a button element could be defined like so: 
```html
<button hx-get="/do-something" hx-trigger="click">
  Do Something
</button>
```

More about the hypertext-focused design in the [References](#references) below.

### Components
Components live in the `components` package, and are defined by 3 files:
* **domain.go** - contains view model structs, which are used to pass data to a template. Each view model must implement `components.Component` 
* **domain.templ** - contains template definitions. 
* **domain_templ.go** - contains go code generated by the `templ generate` command (which is run automatically by the wrapper script).

The view model for the "Account" page is defined in **components/account/account.go**:
```go
type ProfileView struct {
	Provider  string
	Email     string
	Name      string
	AvatarURL string
	components.BaseComponent
}
```

The components are defined in **profile.templ**.  Templ allows us to compose templates, so for the full page component, the _Profile_ component is composed inside the _Page_ component (defined in html.templ):
```html
templ Profile(view ProfileView) {
  <div>
    Hello { view.Name }, your id is { view.ID }.
  </div>
}

templ ProfilePage(view ProfileView) {
  @Page(&view) {
    @Profile(view)
  }
}
```


### Reference

- [HTMX](https://htmx.org/docs/)
- [Locality of Behavior (LoB)](https://htmx.org/essays/locality-of-behaviour/)
- [Islands Architecture](https://github.com/bensmithett/tropical-utils/tree/main/packages/tropical-islands) / [discussion](https://www.patterns.dev/posts/islands-architecture)
- [HATEOAS](https://htmx.org/essays/hateoas/)

## Contributing
Please contribute using [Github Flow](https://guides.github.com/introduction/flow/). Create a branch, add commits, and [open a pull request](https://github.com/fraction/readme-boilerplate/compare/).
